db: test_zw3
debugs: []
cases:
  -
    id: 0
    desc: diff-miaoche
    inputs:
      -
        name: flattenRequest
        columns: ["reqId string","eventTime timestamp","main_id string","new_user_id string","loan_ts bigint","split_id int","time1 string"]
        create: |
          CREATE TABLE IF NOT EXISTS flattenRequest(
          	reqId string,
          	eventTime timestamp,
          	main_id string,
          	new_user_id string,
          	loan_ts bigInt,
          	split_id int,
          	time1 string
          );
        rows:
          - ['000014b8ec0ce8ad7c20f56915fc3a9f_2000-09-11',968601600000,'13624','000014b8ec0ce8ad7c20f56915fc3a9f',5923063887,1,'2000-09-11']
      -
        name: action
        create: |
          CREATE TABLE IF NOT EXISTS action(
          	reqId string,
          	eventTime timestamp,
          	ingestionTime timestamp,
          	actionValue int,
          	index(key=(reqId), ttl=0m, ttl_type=absolute)
          );
        inserts:
          - insert into action values ('000014b8ec0ce8ad7c20f56915fc3a9f_2000-09-11',968601600000,968601600000,0);
      -
        name: bo_bill_detail
        create: |
          CREATE TABLE IF NOT EXISTS bo_bill_detail(
          	ingestionTime timestamp,
          	new_user_id string,
          	bill_ts bigInt,
          	bank_id string,
          	lst_bill_amt double,
          	lst_repay_amt double,
          	card_limit double,
          	cur_blc double,
          	cur_bill_min_repay double,
          	buy_cnt double,
          	cur_bill_amt double,
          	adj_amt double,
          	rev_credit double,
          	avl_amt double,
          	advc_limit double,
          	repay_status string,
          	index(key=(new_user_id), ttl=0m, ttl_type=absolute, ts=`ingestionTime`)
          );
        inserts:
          - insert into bo_bill_detail values (966441600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5920909587,'16',51.71693919790691,48.78645816207608,51.58933610737785,51.799664091574954,48.822455898899634,4.0,49.79404783706583,26.457513110645905,26.457513110645905,26.457513110645905,51.58933610737785,'0');
          - insert into bo_bill_detail values (964454400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5918950767,'2',51.94205040234742,52.598874512673746,51.93387237632103,51.93387237632103,26.457513110645905,3.0,52.59481818582511,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,'0');
          - insert into bo_bill_detail values (950630400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5905234527,'16',51.60229258472921,49.15064597744367,51.58933610737785,51.60169377065059,48.61238422459857,6.0,49.14319179703328,26.457513110645905,26.457513110645905,26.457513110645905,50.36053315841683,'0');
          - insert into bo_bill_detail values (961257600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5884239387,'16',51.58922465011468,51.8106523796024,51.58933610737785,50.91037909896174,48.42646177452984,2.0,51.31735378992179,26.457513110645905,26.457513110645905,26.457513110645905,50.36053315841683,'0');
          - insert into bo_bill_detail values (966528000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5920972167,'6',51.94317086971107,51.998970182110334,51.93387237632103,51.93358932328864,49.66727796044394,0.0,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,51.26219172060438,'0');
          - insert into bo_bill_detail values (974822400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5897781927,'2',51.65759673078105,49.667580975924324,51.93387237632103,51.84769425924358,26.457513110645905,1.0,50.63292505870069,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,'0');
          - insert into bo_bill_detail values (971712000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5894611827,'16',51.60597058480733,48.68377758555718,51.58933610737785,51.580363511708605,48.589732454501124,3.0,47.9899301937396,26.457513110645905,26.457513110645905,26.457513110645905,50.36053315841683,'0');
          - insert into bo_bill_detail values (955987200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5878966887,'16',51.027420079796315,51.027918828813704,51.0440789906136,51.043883081129316,48.019525195486885,0.0,51.04437285343018,26.457513110645905,26.457513110645905,26.457513110645905,49.850784346888666,'0');
          - insert into bo_bill_detail values (958579200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5881563927,'16',51.043883081129316,51.043883081129316,51.58933610737785,51.58922465011468,48.599124477710504,0.0,51.58922465011468,26.457513110645905,26.457513110645905,26.457513110645905,50.36053315841683,'0');
          - insert into bo_bill_detail values (958665600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5913108567,'6',51.932222174676866,52.03442226065357,51.93387237632103,51.93395709937767,49.66854638501111,0.0,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,51.26219172060438,'0');
          - insert into bo_bill_detail values (956505600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5910970407,'2',51.93158576434962,51.93387237632103,51.93387237632103,51.947997073996994,26.457513110645905,1.0,51.95024446525733,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,'0');
          - insert into bo_bill_detail values (969033600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5892018927,'16',51.58823024683053,48.62821608901564,51.58933610737785,51.60597058480733,48.61690035368359,3.0,48.94247746079064,26.457513110645905,26.457513110645905,26.457513110645905,50.36053315841683,'0');
          - insert into bo_bill_detail values (974476800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5865760587,'16',51.04098353284349,51.0440789906136,51.0440789906136,51.040294865919414,48.01597650782497,0.0,51.04339330412898,26.457513110645905,26.457513110645905,26.457513110645905,49.850784346888666,'0');
          - insert into bo_bill_detail values (972144000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5895101307,'2',26.457513110645905,51.18079913405026,51.93387237632103,51.65759673078105,26.457513110645905,1.0,52.117953720383156,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,'0');
          - insert into bo_bill_detail values (951148800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5905732467,'2',47.087959182788964,26.457513110645905,51.93387237632103,51.93352578055914,26.457513110645905,0.0,51.92555343951569,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,'0');
          - insert into bo_bill_detail values (963936000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5886917547,'16',50.91037909896174,50.795689777775436,51.58933610737785,51.59442024095241,48.68997432737052,1.0,51.53996895614121,26.457513110645905,26.457513110645905,26.457513110645905,50.36053315841683,'0');
          - insert into bo_bill_detail values (977068800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5868357567,'16',51.040294865919414,48.67944330002142,51.0440789906136,50.98937242210381,47.96187861208107,2.0,47.89066401711298,26.457513110645905,26.457513110645905,26.457513110645905,49.850784346888666,'0');
          - insert into bo_bill_detail values (956073600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5910515667,'6',51.96310518050283,52.10910860876436,51.93387237632103,51.932222174676866,49.66584742053638,0.0,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,51.26219172060438,'0');
          - insert into bo_bill_detail values (948038400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5871020727,'16',50.98937242210381,51.04015282108783,51.0440789906136,51.03942495757569,48.01482583536048,0.0,51.08769225557169,26.457513110645905,26.457513110645905,26.457513110645905,49.850784346888666,'0');
          - insert into bo_bill_detail values (959097600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5913594627,'2',51.947997073996994,52.61299744359753,51.93387237632103,51.94205040234742,26.457513110645905,3.0,52.610072229564565,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,'0');
          - insert into bo_bill_detail values (961776000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5916270987,'2',51.94205040234742,26.457513110645905,51.93387237632103,51.94205040234742,26.457513110645905,0.0,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,'0');
          - insert into bo_bill_detail values (961257600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5915720727,'16',51.56826349606898,48.71044754464898,51.58933610737785,51.603461124230805,48.614181058617035,3.0,49.22148006714142,26.457513110645905,26.457513110645905,26.457513110645905,50.36053315841683,'0');
          - insert into bo_bill_detail values (947952000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5902552767,'16',51.599192823144044,49.07310770676746,51.58933610737785,51.60229258472921,48.613021918000534,3.0,49.11379134214747,26.457513110645905,26.457513110645905,26.457513110645905,50.36053315841683,'0');
          - insert into bo_bill_detail values (961257600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5915775267,'6',51.93395709937767,49.850784346888666,51.93387237632103,51.951256962656835,49.978867534188886,1.0,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,51.26219172060438,'0');
          - insert into bo_bill_detail values (963936000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5918402067,'16',51.603461124230805,48.73642888025343,51.58933610737785,51.71693919790691,48.734682721856316,4.0,49.918256179478064,26.457513110645905,26.457513110645905,26.457513110645905,50.36053315841683,'0');
          - insert into bo_bill_detail values (966355200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5889332307,'16',51.59442024095241,51.65616032962574,51.58933610737785,51.58823024683053,48.59806580513261,0.0,51.65036011491111,26.457513110645905,26.457513110645905,26.457513110645905,50.36053315841683,'0');
          - insert into bo_bill_detail values (966960000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5921422407,'2',51.93387237632103,51.93387430184657,51.93387237632103,51.97110447161961,26.457513110645905,2.0,51.97110543369267,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,'0');
          - insert into bo_bill_detail values (977414400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5900373327,'2',51.84769425924358,51.8945555911215,51.93387237632103,51.93264098811074,26.457513110645905,1.0,51.97556541298997,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,'0');
          - insert into bo_bill_detail values (953395200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5876312847,'16',51.050959834267566,51.40695478240274,51.0440789906136,51.027420079796315,48.002294736814406,1.0,51.390784193277305,26.457513110645905,26.457513110645905,26.457513110645905,49.850784346888666,'0');
          - insert into bo_bill_detail values (976982400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5899884927,'16',51.599326545992824,48.73642888025343,51.58933610737785,51.599192823144044,48.60971096396274,3.0,48.73391221726407,26.457513110645905,26.457513110645905,26.457513110645905,50.36053315841683,'0');
          - insert into bo_bill_detail values (948470400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5903049387,'2',51.93264098811074,52.606433066688716,51.93387237632103,47.087959182788964,26.457513110645905,3.0,51.96187352280516,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,'0');
          - insert into bo_bill_detail values (953481600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5907920007,'16',51.60169377065059,26.457513110645905,51.58933610737785,51.63982862093948,49.34031921258718,6.0,48.386326580967065,26.457513110645905,26.457513110645905,26.457513110645905,50.36053315841683,'0');
          - insert into bo_bill_detail values (953308800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5907824367,'6',51.93357391899772,26.457513110645905,51.93387237632103,51.96310518050283,50.63784750559605,2.0,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,51.26219172060438,'0');
          - insert into bo_bill_detail values (958579200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5913046587,'16',51.60320145107278,48.6224875957617,51.58933610737785,51.56826349606898,48.57689162554558,3.0,47.36033572516141,26.457513110645905,26.457513110645905,26.457513110645905,50.36053315841683,'0');
          - insert into bo_bill_detail values (963936000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5918408367,'6',51.951256962656835,51.93387237632103,51.93387237632103,51.94317086971107,49.847183471084904,1.0,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,51.26219172060438,'0');
          - insert into bo_bill_detail values (955987200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5910503487,'16',51.63982862093948,49.36352904726323,51.58933610737785,51.60320145107278,48.61394964410935,3.0,48.89360387617178,26.457513110645905,26.457513110645905,26.457513110645905,50.36053315841683,'0');
          - insert into bo_bill_detail values (974304000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5897288487,'16',51.580363511708605,48.68377758555718,51.58933610737785,51.599326545992824,48.60988582582765,3.0,48.9990306026558,26.457513110645905,26.457513110645905,26.457513110645905,50.36053315841683,'0');
          - insert into bo_bill_detail values (953827200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5908292547,'2',51.93352578055914,51.93387237632103,51.93387237632103,51.93158576434962,26.457513110645905,1.0,51.931933335858005,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,'0');
          - insert into bo_bill_detail values (950716800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5905270587,'6',26.457513110645905,26.457513110645905,51.93387237632103,51.93357391899772,49.681316407679866,3.0,26.457513110645905,26.457513110645905,26.457513110645905,26.457513110645905,51.26219172060438,'0');
          - insert into bo_bill_detail values (950803200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5873703267,'16',51.03942495757569,49.708207571788385,51.0440789906136,51.050959834267566,48.1579214667743,1.0,49.752745652878296,26.457513110645905,26.457513110645905,26.457513110645905,49.850784346888666,'0');
      -
        name: bo_browse_history
        create: |
          CREATE TABLE IF NOT EXISTS bo_browse_history(
          	ingestionTime timestamp,
          	new_user_id string,
          	bws_ts bigInt,
          	action string,
          	subaction string,
          	index(key=(new_user_id), ttl=(0m, 9), ttl_type=absandlat, ts=`ingestionTime`)
          );
      -
        name: bo_detail
        create: |
          CREATE TABLE IF NOT EXISTS bo_detail(
          	ingestionTime timestamp,
          	new_user_id string,
          	trx_ts bigInt,
          	trx_typ string,
          	trx_amt double,
          	is_slry string,
          	index(key=(new_user_id), ttl=(0m, 9), ttl_type=absandlat, ts=`ingestionTime`)
          );
        inserts:
          - insert into bo_detail values (946742400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5901291087,'1',42.84831151865846,'0');
          - insert into bo_detail values (947001600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5901550287,'1',40.41522237969254,'0');
          - insert into bo_detail values (947088000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5901636687,'1',39.878775056413154,'0');
          - insert into bo_detail values (947174400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5901723087,'1',44.23001243499712,'0');
          - insert into bo_detail values (947260800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5901809487,'0',39.878775056413154,'0');
          - insert into bo_detail values (947865600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5902414287,'1',43.912592726916046,'0');
          - insert into bo_detail values (947952000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5902500687,'1',44.424108319695065,'0');
          - insert into bo_detail values (948038400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5902587087,'1',42.9582215646784,'0');
          - insert into bo_detail values (948124800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5902673487,'1',42.9582215646784,'0');
          - insert into bo_detail values (948297600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5902846287,'1',42.143743307874296,'0');
          - insert into bo_detail values (948384000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5902932687,'1',39.483615589254235,'0');
          - insert into bo_detail values (950025600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5904574287,'1',37.21554379557015,'0');
          - insert into bo_detail values (950112000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5904660687,'1',37.21554379557015,'0');
          - insert into bo_detail values (950198400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5904747087,'1',40.41522237969254,'0');
          - insert into bo_detail values (950284800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5904833487,'1',42.131818142586724,'0');
          - insert into bo_detail values (950371200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5904919887,'1',37.21554379557015,'0');
          - insert into bo_detail values (950457600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5905006287,'0',45.99504212412464,'0');
          - insert into bo_detail values (950544000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5905092687,'1',40.189050747685,'0');
          - insert into bo_detail values (950630400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5905179087,'1',40.1251928344276,'0');
          - insert into bo_detail values (950716800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5905265487,'1',42.359495983781486,'0');
          - insert into bo_detail values (950803200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5905351887,'1',41.907642501099964,'0');
          - insert into bo_detail values (951235200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5905783887,'1',44.18007695783247,'0');
          - insert into bo_detail values (951494400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5906043087,'1',38.44157384915451,'0');
          - insert into bo_detail values (952704000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5907166287,'0',36.097553933750135,'0');
          - insert into bo_detail values (952963200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5907425487,'1',37.21554379557015,'0');
          - insert into bo_detail values (953049600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5907511887,'1',44.92644766727055,'0');
          - insert into bo_detail values (953136000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5907598287,'1',37.21554379557015,'0');
          - insert into bo_detail values (953222400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5907684687,'1',44.6745531594889,'0');
          - insert into bo_detail values (953308800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5907771087,'1',45.31116529068746,'0');
          - insert into bo_detail values (953395200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5907857487,'1',44.93560503654089,'0');
          - insert into bo_detail values (953481600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5907943887,'1',40.189050747685,'0');
          - insert into bo_detail values (953654400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5908116687,'1',43.2625126408534,'0');
          - insert into bo_detail values (953740800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5908203087,'1',40.6903280891172,'0');
          - insert into bo_detail values (953827200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5908289487,'1',40.189050747685,'0');
          - insert into bo_detail values (954172800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5908635087,'1',40.189050747685,'0');
          - insert into bo_detail values (954259200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5908721487,'1',46.3139395862628,'0');
          - insert into bo_detail values (955468800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5909931087,'0',44.79231742162934,'0');
          - insert into bo_detail values (955555200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5910017487,'0',30.56884361568164,'0');
          - insert into bo_detail values (955641600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5910103887,'1',39.367207165355275,'0');
          - insert into bo_detail values (955814400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5910276687,'1',41.53328785444273,'0');
          - insert into bo_detail values (955900800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5910363087,'1',39.367207165355275,'0');
          - insert into bo_detail values (956073600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5910535887,'0',46.57905537900055,'1');
          - insert into bo_detail values (956160000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5910622287,'1',39.367207165355275,'0');
          - insert into bo_detail values (956246400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5910708687,'1',44.893101920005485,'0');
          - insert into bo_detail values (956332800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5910795087,'0',42.9582215646784,'0');
          - insert into bo_detail values (956419200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5910881487,'1',40.189050747685,'0');
          - insert into bo_detail values (956505600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5910967887,'1',42.9582215646784,'0');
          - insert into bo_detail values (956592000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5911054287,'1',40.8438281751356,'0');
          - insert into bo_detail values (956764800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5911227087,'0',38.05357144868271,'0');
          - insert into bo_detail values (956851200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5911313487,'0',43.757547920330275,'0');
          - insert into bo_detail values (956937600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5911399887,'0',44.54253472805516,'0');
          - insert into bo_detail values (957024000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5911486287,'1',44.969283961388584,'0');
          - insert into bo_detail values (957110400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5911572687,'1',42.9582215646784,'0');
          - insert into bo_detail values (957196800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5911659087,'1',42.143743307874296,'0');
          - insert into bo_detail values (957283200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5911745487,'1',42.63760546747436,'0');
          - insert into bo_detail values (957456000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5911918287,'0',45.09442315852372,'0');
          - insert into bo_detail values (957542400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5912004687,'1',40.1251928344276,'0');
          - insert into bo_detail values (957628800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5912091087,'1',42.54106016544486,'0');
          - insert into bo_detail values (957715200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5912177487,'1',43.78016902662665,'0');
          - insert into bo_detail values (957801600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5912263887,'0',42.9582215646784,'0');
          - insert into bo_detail values (958406400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5912868687,'1',44.94670288241397,'0');
          - insert into bo_detail values (958492800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5912955087,'1',39.367207165355275,'0');
          - insert into bo_detail values (958579200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5913041487,'1',40.189050747685,'0');
          - insert into bo_detail values (958665600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5913127887,'1',43.78016902662665,'0');
          - insert into bo_detail values (958752000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5913214287,'1',40.986157419304384,'0');
          - insert into bo_detail values (958838400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5913300687,'1',42.143743307874296,'0');
          - insert into bo_detail values (958924800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5913387087,'1',39.367207165355275,'0');
          - insert into bo_detail values (959011200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5913473487,'1',39.31737147877513,'0');
          - insert into bo_detail values (959097600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5913559887,'1',39.367207165355275,'0');
          - insert into bo_detail values (959270400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5913732687,'0',42.9582215646784,'0');
          - insert into bo_detail values (959356800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5913819087,'1',40.93392969163845,'0');
          - insert into bo_detail values (959443200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5913905487,'1',42.14136803664542,'0');
          - insert into bo_detail values (959788800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5914251087,'1',40.298387064496765,'0');
          - insert into bo_detail values (960220800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5914683087,'1',44.79231742162934,'0');
          - insert into bo_detail values (960307200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5914769487,'0',46.496681602024026,'1');
          - insert into bo_detail values (960393600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5914855887,'1',38.21717807478726,'0');
          - insert into bo_detail values (960566400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5915028687,'1',44.54253472805516,'0');
          - insert into bo_detail values (960652800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5915115087,'1',43.972516416507254,'0');
          - insert into bo_detail values (960912000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5915374287,'1',38.21717807478726,'0');
          - insert into bo_detail values (960998400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5915460687,'1',38.21717807478726,'0');
          - insert into bo_detail values (961084800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5915547087,'0',43.757547920330275,'0');
          - insert into bo_detail values (961171200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5915633487,'1',38.21717807478726,'0');
          - insert into bo_detail values (961257600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5915719887,'1',44.85326855425366,'0');
          - insert into bo_detail values (961689600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5916151887,'1',44.79231742162934,'0');
          - insert into bo_detail values (962121600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5916583887,'1',39.87071230866085,'0');
          - insert into bo_detail values (962208000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5916670287,'0',43.757547920330275,'0');
          - insert into bo_detail values (962726400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5917188687,'0',43.757547920330275,'0');
          - insert into bo_detail values (963072000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5917534287,'1',45.22220472290134,'0');
          - insert into bo_detail values (963158400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5917620687,'1',43.427583400414996,'0');
          - insert into bo_detail values (963244800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5917707087,'1',44.79231742162934,'0');
          - insert into bo_detail values (963331200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5917793487,'1',39.367207165355275,'0');
          - insert into bo_detail values (963417600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5917879887,'1',38.96689235748727,'0');
          - insert into bo_detail values (963504000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5917966287,'1',40.187806608472684,'0');
          - insert into bo_detail values (963590400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5918052687,'1',38.50666435826402,'0');
          - insert into bo_detail values (963676800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5918139087,'1',40.947203811737864,'0');
          - insert into bo_detail values (963849600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5918311887,'1',44.85326855425366,'0');
          - insert into bo_detail values (963936000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5918398287,'1',42.50697707435804,'0');
          - insert into bo_detail values (964022400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5918484687,'1',40.8438281751356,'0');
          - insert into bo_detail values (964108800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5918571087,'1',41.03004143307682,'0');
          - insert into bo_detail values (964195200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5918657487,'1',42.19024887340676,'0');
          - insert into bo_detail values (964281600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5918743887,'1',40.189050747685,'0');
          - insert into bo_detail values (964368000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5918830287,'1',44.26315171787928,'0');
          - insert into bo_detail values (964540800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5919003087,'1',40.76954991166814,'0');
          - insert into bo_detail values (964627200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5919089487,'1',41.3606636793947,'0');
          - insert into bo_detail values (964713600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5919175887,'1',43.02598749593088,'0');
          - insert into bo_detail values (964800000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5919262287,'1',40.6903280891172,'0');
          - insert into bo_detail values (964886400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5919348687,'1',41.263791633828326,'0');
          - insert into bo_detail values (964972800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5919435087,'1',41.53328785444273,'0');
          - insert into bo_detail values (965059200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5919521487,'1',38.05357144868271,'0');
          - insert into bo_detail values (965318400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5919780687,'1',43.150435687255815,'0');
          - insert into bo_detail values (965404800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5919867087,'1',38.12817199919241,'0');
          - insert into bo_detail values (965491200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5919953487,'1',44.35972948519862,'0');
          - insert into bo_detail values (965577600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5920039887,'1',40.189050747685,'0');
          - insert into bo_detail values (965750400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5920212687,'1',37.21554379557015,'0');
          - insert into bo_detail values (966268800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5920731087,'1',41.907642501099964,'0');
          - insert into bo_detail values (966355200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5920817487,'0',30.56884361568164,'0');
          - insert into bo_detail values (966441600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5920903887,'1',41.53328785444273,'0');
          - insert into bo_detail values (966528000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5920990287,'1',40.05638276230144,'0');
          - insert into bo_detail values (966614400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5921076687,'1',38.13474137843339,'0');
          - insert into bo_detail values (966700800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5921163087,'1',39.548505660770545,'0');
          - insert into bo_detail values (966787200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5921249487,'1',43.757547920330275,'0');
          - insert into bo_detail values (966873600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5921335887,'1',41.75219275678824,'0');
          - insert into bo_detail values (966960000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5921422287,'1',42.5241449061589,'0');
          - insert into bo_detail values (967046400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5921508687,'1',40.189050747685,'0');
          - insert into bo_detail values (967132800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5921595087,'1',41.81688773689405,'0');
          - insert into bo_detail values (967219200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5921681487,'1',30.56884361568164,'0');
          - insert into bo_detail values (967305600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5921767887,'0',36.632983771459294,'0');
          - insert into bo_detail values (967392000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5921854287,'0',45.55948199881118,'0');
          - insert into bo_detail values (967478400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5921940687,'1',43.66837413964482,'0');
          - insert into bo_detail values (967564800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5922027087,'1',42.9582215646784,'0');
          - insert into bo_detail values (967651200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5922113487,'0',42.9582215646784,'0');
          - insert into bo_detail values (967737600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5922199887,'1',42.143743307874296,'0');
          - insert into bo_detail values (967910400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5922372687,'1',42.45387025937682,'0');
          - insert into bo_detail values (968083200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5922545487,'1',42.981263359747814,'0');
          - insert into bo_detail values (968515200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5922977487,'0',37.34324704682227,'0');
          - insert into bo_detail values (968601600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5923063887,'0',45.55948199881118,'0');
          - insert into bo_detail values (971884800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5894811087,'1',37.21554379557015,'0');
          - insert into bo_detail values (972230400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5895156687,'1',38.13474137843339,'0');
          - insert into bo_detail values (972316800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5895243087,'1',37.21554379557015,'0');
          - insert into bo_detail values (972921600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5895847887,'1',42.359495983781486,'0');
          - insert into bo_detail values (973267200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5896193487,'1',37.21554379557015,'0');
          - insert into bo_detail values (973353600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5896279887,'1',41.04228672966457,'0');
          - insert into bo_detail values (973440000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5896366287,'1',39.56939473886352,'0');
          - insert into bo_detail values (973872000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5896798287,'0',43.757547920330275,'0');
          - insert into bo_detail values (974131200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5897057487,'1',42.9582215646784,'0');
          - insert into bo_detail values (974217600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5897143887,'1',43.757547920330275,'0');
          - insert into bo_detail values (974304000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5897230287,'1',43.757547920330275,'0');
          - insert into bo_detail values (974563200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5897489487,'1',44.79231742162934,'0');
          - insert into bo_detail values (974736000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5897662287,'1',36.523756652348894,'0');
          - insert into bo_detail values (974822400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5897748687,'1',40.41522237969254,'0');
          - insert into bo_detail values (974908800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5897835087,'0',42.19024887340676,'0');
          - insert into bo_detail values (974995200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5897921487,'1',40.6903280891172,'0');
          - insert into bo_detail values (975081600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5898007887,'1',38.66247922728184,'0');
          - insert into bo_detail values (975168000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5898094287,'0',44.79231742162934,'0');
          - insert into bo_detail values (975772800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5898699087,'1',42.9582215646784,'0');
          - insert into bo_detail values (976377600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5899303887,'1',37.21554379557015,'0');
          - insert into bo_detail values (976464000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5899390287,'1',37.21554379557015,'0');
          - insert into bo_detail values (976550400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5899476687,'1',39.31737147877513,'0');
          - insert into bo_detail values (976809600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5899735887,'1',44.894525278701856,'0');
          - insert into bo_detail values (976896000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5899822287,'1',42.14255687544362,'0');
          - insert into bo_detail values (977068800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5899995087,'1',42.957057627356185,'0');
          - insert into bo_detail values (977155200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5900081487,'1',43.74606267997155,'0');
          - insert into bo_detail values (977328000000,'000014b8ec0ce8ad7c20f56915fc3a9f',5900254287,'1',43.78016902662665,'0');
          - insert into bo_detail values (977500800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5900427087,'1',42.94652256003971,'0');
          - insert into bo_detail values (977587200000,'000014b8ec0ce8ad7c20f56915fc3a9f',5900513487,'1',42.9582215646784,'0');
          - insert into bo_detail values (977673600000,'000014b8ec0ce8ad7c20f56915fc3a9f',5900599887,'1',42.93470158275238,'0');
          - insert into bo_detail values (977846400000,'000014b8ec0ce8ad7c20f56915fc3a9f',5900772687,'1',43.23059333388798,'0');
          - insert into bo_detail values (977932800000,'000014b8ec0ce8ad7c20f56915fc3a9f',5900859087,'1',42.83541642146134,'0');
      -
        name: bo_user
        create: |
          CREATE TABLE IF NOT EXISTS bo_user(
          	ingestionTime timestamp,
          	new_user_id string,
          	sex string,
          	prof string,
          	edu string,
          	marriage string,
          	hukou_typ string,
          	index(key=(new_user_id), ttl=0m, ttl_type=absolute)
          );
        inserts:
          - insert into bo_user values (1603439606052,'000014b8ec0ce8ad7c20f56915fc3a9f','1','2','3','1','2');
    sql: |
      select
          reqId as reqId_42,
          ingestionTime,
          max(`trx_amt`) over bo_detail_new_user_id_ingestionTime_0s_5529601s_100 as bo_detail_trx_amt_multi_max_41,
          avg(`trx_amt`) over bo_detail_new_user_id_ingestionTime_0s_5529601s_100 as bo_detail_trx_amt_multi_avg_42,
          count(`trx_amt`) over bo_detail_new_user_id_ingestionTime_0s_5529601s_100 as bo_detail_trx_amt_multi_count_43,
          sum(`trx_amt`) over bo_detail_new_user_id_ingestionTime_0s_5529601s_100 as bo_detail_trx_amt_multi_sum_44,
      from
          (select `eventTime` as `ingestionTime`, `new_user_id` as `new_user_id`, bigint(0) as `trx_ts`, '' as `trx_typ`, double(0) as `trx_amt`, '' as `is_slry`, reqId from `flattenRequest`)
      window
      bo_detail_new_user_id_ingestionTime_0s_5529601s_100 as (
        UNION (select `ingestionTime`, `new_user_id`, `trx_ts`, `trx_typ`, `trx_amt`, `is_slry`, '' as reqId from `bo_detail`)
        partition by `new_user_id` order by `ingestionTime` rows_range between 5529600999 preceding and 0s preceding MAXSIZE 100 INSTANCE_NOT_IN_WINDOW);
    expect:
      success: true