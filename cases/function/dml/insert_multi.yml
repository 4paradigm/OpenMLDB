# Copyright 2021 4Paradigm
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#   http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

db: test_zw
debugs: []
cases:
  -
    id: 0
    desc: 所有列插入多条
    inputs:
      -
        create: |
          create table {0} (
          id int not null,
          c1 int not null,
          c2 smallint not null,
          c3 float not null,
          c4 double not null,
          c5 bigint not null,
          c6 string not null,
          c7 timestamp not null,
          c8 date not null,
          c9 bool not null,
          index(key=(c1), ts=c5)
          );
        insert: |
          insert into {0} values
            (1, 1, 2, 3.3f, 4.4, 5L, "aa", 12345678L, "2020-05-21", true),
            (2, 10, 20, 3.31f, 4.41, 50L, "bb", 12345679L, "2020-05-22", false);
    sql: select * from {0};
    expect:
      columns : ["id int","c1 int","c2 smallint","c3 float","c4 double","c5 bigint","c6 string","c7 timestamp","c8 date","c9 bool"]
      order: id
      rows:
        - [1,1,2,3.3,4.4,5,"aa",12345678,"2020-05-21",true]
        - [2,10,20,3.31,4.41,50,"bb",12345679,"2020-05-22",false]
  -
    id: 1
    desc: 部分列插入多条
    inputs:
      -
        create: |
          create table {0} (
          id int,
          c1 int,
          c2 smallint,
          c3 float,
          c5 bigint,
          index(key=(c1), ts=c5)
          );
        insert: |
          insert into {0} (id,c3,c5)values
            (1, 3.3,12345678),
            (2, 3.31,12345679);
    sql: select * from {0};
    expect:
      columns : ["id int","c1 int","c2 smallint","c3 float","c5 bigint"]
      order: id
      rows:
        - [1,null,null,3.3,12345678]
        - [2,null,null,3.31,12345679]
  -
    id: 2
    desc: 其中一条数据类型不兼容
    inputs:
      -
        create: |
          create table {0} (
          id int,
          c1 int,
          c2 smallint,
          c3 float,
          c5 bigint,
          index(key=(c1), ts=c5)
          );
    sql: |
      insert into {0} (id,c3,c5)values
                  (1, 3.3,12345678),
                  (2, "aa",12345679);
    expect:
      success: false
  -
    id: 3
    desc: 插入多个null
    inputs:
      -
        create: |
          create table {0} (
          id int,
          c1 int,
          c2 smallint,
          c3 float,
          c5 bigint,
          index(key=(c1), ts=c5)
          );
        insert: |
          insert into {0} (id,c2,c3,c5)values
            (1, null,null,12345678),
            (2, null,null,12345679);
    sql: select * from {0};
    expect:
      columns : ["id int","c1 int","c2 smallint","c3 float","c5 bigint"]
      order: id
      rows:
        - [1,null,null,null,12345678]
        - [2,null,null,null,12345679]
  -
    id: 4
    desc: 插入多条空串
    mode: cli-unsupport
    inputs:
      -
        create: |
          create table {0} (
          id int,
          c1 int,
          c2 string,
          c3 float,
          c5 bigint,
          index(key=(c1), ts=c5)
          );
        insert: |
          insert into {0} (id,c2,c3,c5)values
            (1, "",null,12345678),
            (2, "",null,12345679);
    sql: select * from {0};
    expect:
      columns : ["id int","c1 int","c2 string","c3 float","c5 bigint"]
      order: id
      rows:
        - [1,null,"",null,12345678]
        - [2,null,"",null,12345679]
  -
    id: 5
    desc: 插入数据和列的数量不匹配
    inputs:
      -
        create: |
          create table {0} (
          id int,
          c1 int,
          c2 smallint,
          c3 float,
          c5 bigint,
          index(key=(c1), ts=c5)
          );
    sql: |
      insert into {0} (id,c3,c5)values
                  (1,12345678),
                  (2,12345679);
    expect:
      success: false
  -
    id: 6
    desc: 其中一条数据少一列
    inputs:
      -
        create: |
          create table {0} (
          id int,
          c1 int,
          c2 smallint,
          c3 float,
          c5 bigint,
          index(key=(c1), ts=c5)
          );
    sql: |
      insert into {0} (id,c3,c5)values
                  (1, 3.3,12345678),
                  (2,12345679);
    expect:
      success: false
