# start sql code
# output table name: sql_table
select * from 
(
select
    reqId as reqId_1,
    `reqId` as batch100426_flatten_request_reqId_original_0,
    `eventTime` as batch100426_flatten_request_eventTime_original_1,
    `cino` as batch100426_flatten_request_cino_original_2,
    `sample_date` as batch100426_flatten_request_sample_date_original_3,
    `previous_month_last_day` as batch100426_flatten_request_previous_month_last_day_original_4
from
    `batch100426_flatten_request`
    )
as out0
last join
(
select
    batch100426_flatten_request.reqId as reqId_6,
    `batch100416_feedbackTable_reqId`.`actionValue` as batch100416_feedbackTable_actionValue_multi_direct_5,
    `batch100416_feedbackTable_reqId`.`cino` as batch100416_feedbackTable_cino_multi_direct_6,
    `batch100416_feedbackTable_reqId`.`previous_month_last_day` as batch100416_feedbackTable_previous_month_last_day_multi_direct_7,
    `batch100416_feedbackTable_reqId`.`sample_date` as batch100416_feedbackTable_sample_date_multi_direct_8,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_admin_level_cd` as batch100418_c01_indv_cust_basic_info_c01006_admin_level_cd_multi_direct_9,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_belong_corp_type_cd` as batch100418_c01_indv_cust_basic_info_c01006_belong_corp_type_cd_multi_direct_10,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_belong_level1_branch` as batch100418_c01_indv_cust_basic_info_c01006_belong_level1_branch_multi_direct_11,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_belong_level2_branch` as batch100418_c01_indv_cust_basic_info_c01006_belong_level2_branch_multi_direct_12,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_belong_subbranch` as batch100418_c01_indv_cust_basic_info_c01006_belong_subbranch_multi_direct_13,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_birth_dt` as batch100418_c01_indv_cust_basic_info_c01006_birth_dt_multi_direct_14,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_black_card_cust_ind` as batch100418_c01_indv_cust_basic_info_c01006_black_card_cust_ind_multi_direct_15,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_blklist_cust_ind` as batch100418_c01_indv_cust_basic_info_c01006_blklist_cust_ind_multi_direct_16,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_career_cd` as batch100418_c01_indv_cust_basic_info_c01006_career_cd_multi_direct_17,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_cert_num` as batch100418_c01_indv_cust_basic_info_c01006_cert_num_multi_direct_18,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_cert_num_valid_dt` as batch100418_c01_indv_cust_basic_info_c01006_cert_num_valid_dt_multi_direct_19,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_cert_type_cd` as batch100418_c01_indv_cust_basic_info_c01006_cert_type_cd_multi_direct_20,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_corp_addr` as batch100418_c01_indv_cust_basic_info_c01006_corp_addr_multi_direct_21,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_corp_name` as batch100418_c01_indv_cust_basic_info_c01006_corp_name_multi_direct_22,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_corp_tel` as batch100418_c01_indv_cust_basic_info_c01006_corp_tel_multi_direct_23,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_corp_type_cd` as batch100418_c01_indv_cust_basic_info_c01006_corp_type_cd_multi_direct_24,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_curr_work_start_dt` as batch100418_c01_indv_cust_basic_info_c01006_curr_work_start_dt_multi_direct_25,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_edu_degree_cd` as batch100418_c01_indv_cust_basic_info_c01006_edu_degree_cd_multi_direct_26,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_elite_cust_ind` as batch100418_c01_indv_cust_basic_info_c01006_elite_cust_ind_multi_direct_27,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_family_addr_zip_cd` as batch100418_c01_indv_cust_basic_info_c01006_family_addr_zip_cd_multi_direct_28,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_gender_cd` as batch100418_c01_indv_cust_basic_info_c01006_gender_cd_multi_direct_29,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_gold_card_ind` as batch100418_c01_indv_cust_basic_info_c01006_gold_card_ind_multi_direct_30,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_home_addr` as batch100418_c01_indv_cust_basic_info_c01006_home_addr_multi_direct_31,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_home_tel` as batch100418_c01_indv_cust_basic_info_c01006_home_tel_multi_direct_32,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_indv_webbank_ind` as batch100418_c01_indv_cust_basic_info_c01006_indv_webbank_ind_multi_direct_33,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_last_update_dt` as batch100418_c01_indv_cust_basic_info_c01006_last_update_dt_multi_direct_34,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_marriage_status_cd` as batch100418_c01_indv_cust_basic_info_c01006_marriage_status_cd_multi_direct_35,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_mobile` as batch100418_c01_indv_cust_basic_info_c01006_mobile_multi_direct_36,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_nation_cd` as batch100418_c01_indv_cust_basic_info_c01006_nation_cd_multi_direct_37,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_note_mobbank_ind` as batch100418_c01_indv_cust_basic_info_c01006_note_mobbank_ind_multi_direct_38,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_party_age` as batch100418_c01_indv_cust_basic_info_c01006_party_age_multi_direct_39,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_party_name` as batch100418_c01_indv_cust_basic_info_c01006_party_name_multi_direct_40,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_per_bank_cust_ind` as batch100418_c01_indv_cust_basic_info_c01006_per_bank_cust_ind_multi_direct_41,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_plati_card_cust_ind` as batch100418_c01_indv_cust_basic_info_c01006_plati_card_cust_ind_multi_direct_42,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_pre_apprv_cust_ind` as batch100418_c01_indv_cust_basic_info_c01006_pre_apprv_cust_ind_multi_direct_43,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_scd_nation_cd` as batch100418_c01_indv_cust_basic_info_c01006_scd_nation_cd_multi_direct_44,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_serv_cust_mger` as batch100418_c01_indv_cust_basic_info_c01006_serv_cust_mger_multi_direct_45,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_setup_cust_org` as batch100418_c01_indv_cust_basic_info_c01006_setup_cust_org_multi_direct_46,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_setup_dt` as batch100418_c01_indv_cust_basic_info_c01006_setup_dt_multi_direct_47,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_status` as batch100418_c01_indv_cust_basic_info_c01006_status_multi_direct_48,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_telbank_ind` as batch100418_c01_indv_cust_basic_info_c01006_telbank_ind_multi_direct_49,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_vip_cust_ind` as batch100418_c01_indv_cust_basic_info_c01006_vip_cust_ind_multi_direct_50,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_wap_mobbank_ind` as batch100418_c01_indv_cust_basic_info_c01006_wap_mobbank_ind_multi_direct_51,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_year_income` as batch100418_c01_indv_cust_basic_info_c01006_year_income_multi_direct_52,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_zone_num` as batch100418_c01_indv_cust_basic_info_c01006_zone_num_multi_direct_53,
    `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`ingestionTime` as batch100418_c01_indv_cust_basic_info_ingestionTime_multi_direct_54,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`agrunno` as batch100424_dcm_bcs_bthrspea_s_agrunno_multi_last_value_333,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`allyno` as batch100424_dcm_bcs_bthrspea_s_allyno_multi_last_value_334,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`ass3` as batch100424_dcm_bcs_bthrspea_s_ass3_multi_last_value_335,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`backup` as batch100424_dcm_bcs_bthrspea_s_backup_multi_last_value_336,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`backup3` as batch100424_dcm_bcs_bthrspea_s_backup3_multi_last_value_337,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`bankcardavgamt6` as batch100424_dcm_bcs_bthrspea_s_bankcardavgamt6_multi_last_value_338,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`birthdate` as batch100424_dcm_bcs_bthrspea_s_birthdate_multi_last_value_339,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`cardkind` as batch100424_dcm_bcs_bthrspea_s_cardkind_multi_last_value_340,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`cardlogo` as batch100424_dcm_bcs_bthrspea_s_cardlogo_multi_last_value_341,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`cardtype` as batch100424_dcm_bcs_bthrspea_s_cardtype_multi_last_value_342,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`chardata1` as batch100424_dcm_bcs_bthrspea_s_chardata1_multi_last_value_343,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`chardata2` as batch100424_dcm_bcs_bthrspea_s_chardata2_multi_last_value_344,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`chnltype` as batch100424_dcm_bcs_bthrspea_s_chnltype_multi_last_value_345,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`clientkind` as batch100424_dcm_bcs_bthrspea_s_clientkind_multi_last_value_346,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`clientlv` as batch100424_dcm_bcs_bthrspea_s_clientlv_multi_last_value_347,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`consmloanavgbal6` as batch100424_dcm_bcs_bthrspea_s_consmloanavgbal6_multi_last_value_348,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`crdtcardavgamt6` as batch100424_dcm_bcs_bthrspea_s_crdtcardavgamt6_multi_last_value_349,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`crdtcrdodavgbal6` as batch100424_dcm_bcs_bthrspea_s_crdtcrdodavgbal6_multi_last_value_350,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`crdtdpsitavgbal6` as batch100424_dcm_bcs_bthrspea_s_crdtdpsitavgbal6_multi_last_value_351,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`crdtlevel` as batch100424_dcm_bcs_bthrspea_s_crdtlevel_multi_last_value_352,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`crdtscore` as batch100424_dcm_bcs_bthrspea_s_crdtscore_multi_last_value_353,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`crezono` as batch100424_dcm_bcs_bthrspea_s_crezono_multi_last_value_354,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`csortcode` as batch100424_dcm_bcs_bthrspea_s_csortcode_multi_last_value_355,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`cunscore` as batch100424_dcm_bcs_bthrspea_s_cunscore_multi_last_value_356,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`currdpsitavgbal6` as batch100424_dcm_bcs_bthrspea_s_currdpsitavgbal6_multi_last_value_357,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`currfundavgbal6` as batch100424_dcm_bcs_bthrspea_s_currfundavgbal6_multi_last_value_358,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`currpeaf` as batch100424_dcm_bcs_bthrspea_s_currpeaf_multi_last_value_359,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`custcode` as batch100424_dcm_bcs_bthrspea_s_custcode_multi_last_value_360,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`custname` as batch100424_dcm_bcs_bthrspea_s_custname_multi_last_value_361,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`custrank` as batch100424_dcm_bcs_bthrspea_s_custrank_multi_last_value_362,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`custsort` as batch100424_dcm_bcs_bthrspea_s_custsort_multi_last_value_363,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`deadline` as batch100424_dcm_bcs_bthrspea_s_deadline_multi_last_value_364,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`debtcardavgamt6` as batch100424_dcm_bcs_bthrspea_s_debtcardavgamt6_multi_last_value_365,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`dpsitavgbal6` as batch100424_dcm_bcs_bthrspea_s_dpsitavgbal6_multi_last_value_366,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`dsbrno` as batch100424_dcm_bcs_bthrspea_s_dsbrno_multi_last_value_367,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`dsempycode` as batch100424_dcm_bcs_bthrspea_s_dsempycode_multi_last_value_368,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`dszono` as batch100424_dcm_bcs_bthrspea_s_dszono_multi_last_value_369,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`eacode` as batch100424_dcm_bcs_bthrspea_s_eacode_multi_last_value_370,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`eadate` as batch100424_dcm_bcs_bthrspea_s_eadate_multi_last_value_371,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`efftdate` as batch100424_dcm_bcs_bthrspea_s_efftdate_multi_last_value_372,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`extdata1` as batch100424_dcm_bcs_bthrspea_s_extdata1_multi_last_value_373,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`extdata2` as batch100424_dcm_bcs_bthrspea_s_extdata2_multi_last_value_374,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`extdata3` as batch100424_dcm_bcs_bthrspea_s_extdata3_multi_last_value_375,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`extdata4` as batch100424_dcm_bcs_bthrspea_s_extdata4_multi_last_value_376,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`extdata5` as batch100424_dcm_bcs_bthrspea_s_extdata5_multi_last_value_377,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`field1` as batch100424_dcm_bcs_bthrspea_s_field1_multi_last_value_378,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`field2` as batch100424_dcm_bcs_bthrspea_s_field2_multi_last_value_379,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`field3` as batch100424_dcm_bcs_bthrspea_s_field3_multi_last_value_380,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`field4` as batch100424_dcm_bcs_bthrspea_s_field4_multi_last_value_381,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`field5` as batch100424_dcm_bcs_bthrspea_s_field5_multi_last_value_382,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`field6` as batch100424_dcm_bcs_bthrspea_s_field6_multi_last_value_383,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`field9` as batch100424_dcm_bcs_bthrspea_s_field9_multi_last_value_384,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`forgncurtp` as batch100424_dcm_bcs_bthrspea_s_forgncurtp_multi_last_value_385,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`frnllmt` as batch100424_dcm_bcs_bthrspea_s_frnllmt_multi_last_value_386,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`frnulmt` as batch100424_dcm_bcs_bthrspea_s_frnulmt_multi_last_value_387,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`goldavgbal6` as batch100424_dcm_bcs_bthrspea_s_goldavgbal6_multi_last_value_388,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`groupno` as batch100424_dcm_bcs_bthrspea_s_groupno_multi_last_value_389,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`halfyearavgasse` as batch100424_dcm_bcs_bthrspea_s_halfyearavgasse_multi_last_value_390,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`halfyearavglong` as batch100424_dcm_bcs_bthrspea_s_halfyearavglong_multi_last_value_391,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`halfyearavgshor` as batch100424_dcm_bcs_bthrspea_s_halfyearavgshor_multi_last_value_392,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`houseloanavgbal6` as batch100424_dcm_bcs_bthrspea_s_houseloanavgbal6_multi_last_value_393,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`iasc` as batch100424_dcm_bcs_bthrspea_s_iasc_multi_last_value_394,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`ifsc` as batch100424_dcm_bcs_bthrspea_s_ifsc_multi_last_value_395,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`ingestionTime` as batch100424_dcm_bcs_bthrspea_s_ingestionTime_multi_last_value_396,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`insureavgbal6` as batch100424_dcm_bcs_bthrspea_s_insureavgbal6_multi_last_value_397,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`ipcc` as batch100424_dcm_bcs_bthrspea_s_ipcc_multi_last_value_398,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`isstcst` as batch100424_dcm_bcs_bthrspea_s_isstcst_multi_last_value_399,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`liabavgbal6` as batch100424_dcm_bcs_bthrspea_s_liabavgbal6_multi_last_value_400,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`loanavgbal6` as batch100424_dcm_bcs_bthrspea_s_loanavgbal6_multi_last_value_401,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`lstubrno` as batch100424_dcm_bcs_bthrspea_s_lstubrno_multi_last_value_402,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`lstudate` as batch100424_dcm_bcs_bthrspea_s_lstudate_multi_last_value_403,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`lstutime` as batch100424_dcm_bcs_bthrspea_s_lstutime_multi_last_value_404,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`lstutlno` as batch100424_dcm_bcs_bthrspea_s_lstutlno_multi_last_value_405,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`lstuzono` as batch100424_dcm_bcs_bthrspea_s_lstuzono_multi_last_value_406,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`ltkxavgbal6` as batch100424_dcm_bcs_bthrspea_s_ltkxavgbal6_multi_last_value_407,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`minxwscore` as batch100424_dcm_bcs_bthrspea_s_minxwscore_multi_last_value_408,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`ncurrfundavgbal6` as batch100424_dcm_bcs_bthrspea_s_ncurrfundavgbal6_multi_last_value_409,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`nltkxavgbal6` as batch100424_dcm_bcs_bthrspea_s_nltkxavgbal6_multi_last_value_410,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`notes` as batch100424_dcm_bcs_bthrspea_s_notes_multi_last_value_411,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`operloanavgbal6` as batch100424_dcm_bcs_bthrspea_s_operloanavgbal6_multi_last_value_412,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`percrlmt` as batch100424_dcm_bcs_bthrspea_s_percrlmt_multi_last_value_413,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`plancode` as batch100424_dcm_bcs_bthrspea_s_plancode_multi_last_value_414,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`presvmgmtavgbal6` as batch100424_dcm_bcs_bthrspea_s_presvmgmtavgbal6_multi_last_value_415,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`providpsitavgbal6` as batch100424_dcm_bcs_bthrspea_s_providpsitavgbal6_multi_last_value_416,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`recomcred` as batch100424_dcm_bcs_bthrspea_s_recomcred_multi_last_value_417,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`rmbllmt` as batch100424_dcm_bcs_bthrspea_s_rmbllmt_multi_last_value_418,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`rmbulmt` as batch100424_dcm_bcs_bthrspea_s_rmbulmt_multi_last_value_419,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`salarycusttype` as batch100424_dcm_bcs_bthrspea_s_salarycusttype_multi_last_value_420,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`scrmarkll` as batch100424_dcm_bcs_bthrspea_s_scrmarkll_multi_last_value_421,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`scrmarkul` as batch100424_dcm_bcs_bthrspea_s_scrmarkul_multi_last_value_422,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`setbrno` as batch100424_dcm_bcs_bthrspea_s_setbrno_multi_last_value_423,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`setdate` as batch100424_dcm_bcs_bthrspea_s_setdate_multi_last_value_424,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`settime` as batch100424_dcm_bcs_bthrspea_s_settime_multi_last_value_425,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`settlno` as batch100424_dcm_bcs_bthrspea_s_settlno_multi_last_value_426,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`setzono` as batch100424_dcm_bcs_bthrspea_s_setzono_multi_last_value_427,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`syscore` as batch100424_dcm_bcs_bthrspea_s_syscore_multi_last_value_428,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`tbmbflag` as batch100424_dcm_bcs_bthrspea_s_tbmbflag_multi_last_value_429,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`tbondavgbal6` as batch100424_dcm_bcs_bthrspea_s_tbondavgbal6_multi_last_value_430,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`timedpsitavgbal6` as batch100424_dcm_bcs_bthrspea_s_timedpsitavgbal6_multi_last_value_431,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`tizocode` as batch100424_dcm_bcs_bthrspea_s_tizocode_multi_last_value_432,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`tlcrdtyp` as batch100424_dcm_bcs_bthrspea_s_tlcrdtyp_multi_last_value_433,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`unitname` as batch100424_dcm_bcs_bthrspea_s_unitname_multi_last_value_434,
    `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`xwscore` as batch100424_dcm_bcs_bthrspea_s_xwscore_multi_last_value_435
from
    `batch100426_flatten_request`
    last join `batch100416_feedbackTable` as `batch100416_feedbackTable_reqId` on `batch100426_flatten_request`.`reqId` = `batch100416_feedbackTable_reqId`.`reqId`
    last join `batch100418_c01_indv_cust_basic_info` as `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt` on `batch100426_flatten_request`.`cino` = `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`c01006_party_id` and `batch100426_flatten_request`.`previous_month_last_day` = `batch100418_c01_indv_cust_basic_info_c01006_party_id_pt_dt`.`pt_dt`
    last join `batch100424_dcm_bcs_bthrspea_s` as `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d` order by batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d.`ingestionTime` on `batch100426_flatten_request`.`cino` = `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`cino` and `batch100426_flatten_request`.`previous_month_last_day` = `batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d`.`pt_dt` and batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d.`ingestionTime` < batch100426_flatten_request.`eventTime` - 0 and batch100424_dcm_bcs_bthrspea_s_cino_pt_dt__eventTime_0s_100d.`ingestionTime` > batch100426_flatten_request.`eventTime` - 8640000000)
as out1
on out0.reqId_1 = out1.reqId_6
last join
(
select
    reqId as reqId_56,
    min(`c01007_asset_total_bal`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_asset_total_bal_multi_min_55,
    min(`c01007_asset_total_bal`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_asset_total_bal_multi_min_56,
    min(`c01007_avg_asset_bal_12`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_avg_asset_bal_12_multi_min_57,
    min(`c01007_avg_asset_bal_12`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_avg_asset_bal_12_multi_min_58,
    avg(`c01007_avg_asset_bal_3`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_avg_asset_bal_3_multi_avg_59,
    avg(`c01007_avg_asset_bal_3`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_avg_asset_bal_3_multi_avg_60,
    min(`c01007_avg_asset_bal_6`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_avg_asset_bal_6_multi_min_61,
    min(`c01007_avg_asset_bal_6`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_avg_asset_bal_6_multi_min_62,
    avg(`c01007_avg_asset_bal_month`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_avg_asset_bal_month_multi_avg_63,
    avg(`c01007_avg_asset_bal_month`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_avg_asset_bal_month_multi_avg_64,
    avg(`c01007_avg_asset_bal_year`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_avg_asset_bal_year_multi_avg_65,
    avg(`c01007_avg_asset_bal_year`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_avg_asset_bal_year_multi_avg_66,
    max(`c01007_avg_dpsit_bal_12`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_avg_dpsit_bal_12_multi_max_67,
    max(`c01007_avg_dpsit_bal_12`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_avg_dpsit_bal_12_multi_max_68,
    max(`c01007_avg_dpsit_bal_3`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_avg_dpsit_bal_3_multi_max_69,
    max(`c01007_avg_dpsit_bal_3`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_avg_dpsit_bal_3_multi_max_70,
    max(`c01007_card_total_bal`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_card_total_bal_multi_max_71,
    max(`c01007_card_total_bal`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_card_total_bal_multi_max_72,
    max(`c01007_dpsit_total_bal`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_dpsit_total_bal_multi_max_73,
    max(`c01007_dpsit_total_bal`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_dpsit_total_bal_multi_max_74,
    max(`c01007_liab_total_bal`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_liab_total_bal_multi_max_75,
    max(`c01007_liab_total_bal`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_liab_total_bal_multi_max_76,
    max(`c01007_loan_total_bal`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_loan_total_bal_multi_max_77,
    max(`c01007_loan_total_bal`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_loan_total_bal_multi_max_78,
    min(`c01007_mid_busi_total_bal`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_mid_busi_total_bal_multi_min_79,
    min(`c01007_mid_busi_total_bal`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_mid_busi_total_bal_multi_min_80,
    case when !isnull(at(`c01007_acct_max_belong_org_num`, 1)) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d then count(`c01007_acct_max_belong_org_num`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100417_c01_cust_belong_info_c01007_acct_max_belong_org_num_multi_count_81,
    case when !isnull(at(`c01007_acct_max_belong_org_num`, 1)) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d then count(`c01007_acct_max_belong_org_num`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d else null end as batch100417_c01_cust_belong_info_c01007_acct_max_belong_org_num_multi_count_82,
    topn_frequency(`c01007_asset_max_belong_org_num`, 3) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_asset_max_belong_org_num_multi_top3frequency_83,
    topn_frequency(`c01007_asset_max_belong_org_num`, 3) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_asset_max_belong_org_num_multi_top3frequency_84,
    distinct_count(`c01007_chrem_acct_belong_org_num`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_chrem_acct_belong_org_num_multi_unique_count_85,
    distinct_count(`c01007_chrem_acct_belong_org_num`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_chrem_acct_belong_org_num_multi_unique_count_86,
    case when !isnull(at(`c01007_cust_belong_org_num`, 1)) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d then count(`c01007_cust_belong_org_num`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100417_c01_cust_belong_info_c01007_cust_belong_org_num_multi_count_87,
    case when !isnull(at(`c01007_cust_belong_org_num`, 1)) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d then count(`c01007_cust_belong_org_num`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d else null end as batch100417_c01_cust_belong_info_c01007_cust_belong_org_num_multi_count_88,
    distinct_count(`c01007_cust_mger_belong_org_num`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_cust_mger_belong_org_num_multi_unique_count_89,
    distinct_count(`c01007_cust_mger_belong_org_num`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_cust_mger_belong_org_num_multi_unique_count_90,
    distinct_count(`c01007_cust_mger_id`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_cust_mger_id_multi_unique_count_91,
    distinct_count(`c01007_cust_mger_id`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_cust_mger_id_multi_unique_count_92,
    distinct_count(`c01007_cust_mger_name`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_cust_mger_name_multi_unique_count_93,
    distinct_count(`c01007_cust_mger_name`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_cust_mger_name_multi_unique_count_94,
    distinct_count(`c01007_deflt_cust_ind`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_deflt_cust_ind_multi_unique_count_95,
    distinct_count(`c01007_deflt_cust_ind`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_deflt_cust_ind_multi_unique_count_96,
    distinct_count(`c01007_elite_cust_ind`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_elite_cust_ind_multi_unique_count_97,
    distinct_count(`c01007_elite_cust_ind`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_elite_cust_ind_multi_unique_count_98,
    topn_frequency(`c01007_etime_cust_ind`, 3) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_etime_cust_ind_multi_top3frequency_99,
    topn_frequency(`c01007_etime_cust_ind`, 3) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_etime_cust_ind_multi_top3frequency_100,
    distinct_count(`c01007_moneylink_cust_ind`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_moneylink_cust_ind_multi_unique_count_101,
    distinct_count(`c01007_moneylink_cust_ind`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_moneylink_cust_ind_multi_unique_count_102,
    distinct_count(`c01007_valid_cust_ind`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_valid_cust_ind_multi_unique_count_103,
    distinct_count(`c01007_valid_cust_ind`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_valid_cust_ind_multi_unique_count_104,
    distinct_count(`c01007_zone_num`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as batch100417_c01_cust_belong_info_c01007_zone_num_multi_unique_count_105,
    distinct_count(`c01007_zone_num`) over batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as batch100417_c01_cust_belong_info_c01007_zone_num_multi_unique_count_106
from
    (select `eventTime` as `ingestionTime`, `cino` as `c01007_party_id`, '' as `c01007_zone_num`, '' as `c01007_cust_mger_id`, '' as `c01007_cust_mger_name`, '' as `c01007_cust_mger_belong_org_num`, '' as `c01007_chrem_acct_belong_org_num`, '' as `c01007_asset_max_belong_org_num`, '' as `c01007_acct_max_belong_org_num`, '' as `c01007_cust_belong_org_num`, float(0) as `c01007_asset_total_bal`, float(0) as `c01007_liab_total_bal`, float(0) as `c01007_dpsit_total_bal`, float(0) as `c01007_loan_total_bal`, float(0) as `c01007_card_total_bal`, float(0) as `c01007_mid_busi_total_bal`, float(0) as `c01007_avg_asset_bal_month`, float(0) as `c01007_avg_asset_bal_year`, float(0) as `c01007_avg_asset_bal_3`, float(0) as `c01007_avg_asset_bal_6`, float(0) as `c01007_avg_asset_bal_12`, float(0) as `c01007_avg_dpsit_bal_3`, float(0) as `c01007_avg_dpsit_bal_12`, '' as `c01007_elite_cust_ind`, '' as `c01007_moneylink_cust_ind`, '' as `c01007_etime_cust_ind`, '' as `c01007_deflt_cust_ind`, '' as `c01007_valid_cust_ind`, `previous_month_last_day` as `pt_dt`, reqId from `batch100426_flatten_request`)
    window batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_64d as (
UNION (select `ingestionTime`, `c01007_party_id`, `c01007_zone_num`, `c01007_cust_mger_id`, `c01007_cust_mger_name`, `c01007_cust_mger_belong_org_num`, `c01007_chrem_acct_belong_org_num`, `c01007_asset_max_belong_org_num`, `c01007_acct_max_belong_org_num`, `c01007_cust_belong_org_num`, `c01007_asset_total_bal`, `c01007_liab_total_bal`, `c01007_dpsit_total_bal`, `c01007_loan_total_bal`, `c01007_card_total_bal`, `c01007_mid_busi_total_bal`, `c01007_avg_asset_bal_month`, `c01007_avg_asset_bal_year`, `c01007_avg_asset_bal_3`, `c01007_avg_asset_bal_6`, `c01007_avg_asset_bal_12`, `c01007_avg_dpsit_bal_3`, `c01007_avg_dpsit_bal_12`, `c01007_elite_cust_ind`, `c01007_moneylink_cust_ind`, `c01007_etime_cust_ind`, `c01007_deflt_cust_ind`, `c01007_valid_cust_ind`, `pt_dt`, '' as reqId from `batch100417_c01_cust_belong_info`) partition by `c01007_party_id`,`pt_dt` order by `ingestionTime` rows_range between 64d preceding and 0s preceding INSTANCE_NOT_IN_WINDOW),
    batch100417_c01_cust_belong_info_c01007_party_id_pt_dt_ingestionTime_0s_32d as (
UNION (select `ingestionTime`, `c01007_party_id`, `c01007_zone_num`, `c01007_cust_mger_id`, `c01007_cust_mger_name`, `c01007_cust_mger_belong_org_num`, `c01007_chrem_acct_belong_org_num`, `c01007_asset_max_belong_org_num`, `c01007_acct_max_belong_org_num`, `c01007_cust_belong_org_num`, `c01007_asset_total_bal`, `c01007_liab_total_bal`, `c01007_dpsit_total_bal`, `c01007_loan_total_bal`, `c01007_card_total_bal`, `c01007_mid_busi_total_bal`, `c01007_avg_asset_bal_month`, `c01007_avg_asset_bal_year`, `c01007_avg_asset_bal_3`, `c01007_avg_asset_bal_6`, `c01007_avg_asset_bal_12`, `c01007_avg_dpsit_bal_3`, `c01007_avg_dpsit_bal_12`, `c01007_elite_cust_ind`, `c01007_moneylink_cust_ind`, `c01007_etime_cust_ind`, `c01007_deflt_cust_ind`, `c01007_valid_cust_ind`, `pt_dt`, '' as reqId from `batch100417_c01_cust_belong_info`) partition by `c01007_party_id`,`pt_dt` order by `ingestionTime` rows_range between 32d preceding and 0s preceding INSTANCE_NOT_IN_WINDOW))
as out2
on out0.reqId_1 = out2.reqId_56
last join
(
select
    reqId as reqId_108,
    min(`c03039_amort_pay_adv_money_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_amort_pay_adv_money_amt_multi_min_107,
    min(`c03039_amort_pay_adv_money_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_32d as batch100421_card_amort_pay_agt_c03039_amort_pay_adv_money_amt_multi_min_108,
    min(`c03039_amort_pay_deduct_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_32d as batch100421_card_amort_pay_agt_c03039_amort_pay_deduct_amt_multi_min_109,
    max(`c03039_amort_pay_deduct_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_32d as batch100421_card_amort_pay_agt_c03039_amort_pay_deduct_amt_multi_max_110,
    min(`c03039_amort_pay_deflt_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_amort_pay_deflt_amt_multi_min_111,
    min(`c03039_amort_pay_deflt_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_32d as batch100421_card_amort_pay_agt_c03039_amort_pay_deflt_amt_multi_min_112,
    avg(`c03039_amort_pay_od_prin`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_amort_pay_od_prin_multi_avg_113,
    min(`c03039_amort_pay_od_prin`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_amort_pay_od_prin_multi_min_114,
    avg(`c03039_amort_pay_remain_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_amort_pay_remain_amt_multi_avg_115,
    max(`c03039_amort_pay_remain_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_32d as batch100421_card_amort_pay_agt_c03039_amort_pay_remain_amt_multi_max_116,
    max(`c03039_amort_pay_tx_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_amort_pay_tx_amt_multi_max_117,
    max(`c03039_amort_pay_tx_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_32d as batch100421_card_amort_pay_agt_c03039_amort_pay_tx_amt_multi_max_118,
    min(`c03039_amort_pay_unback_cash_prin_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_32d as batch100421_card_amort_pay_agt_c03039_amort_pay_unback_cash_prin_amt_multi_min_119,
    max(`c03039_amort_pay_unback_cash_prin_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_32d as batch100421_card_amort_pay_agt_c03039_amort_pay_unback_cash_prin_amt_multi_max_120,
    min(`c03039_card_hlder_comm_fee`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_32d as batch100421_card_amort_pay_agt_c03039_card_hlder_comm_fee_multi_min_121,
    avg(`c03039_card_hlder_comm_fee`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_32d as batch100421_card_amort_pay_agt_c03039_card_hlder_comm_fee_multi_avg_122,
    min(`c03039_consm_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_consm_amt_multi_min_123,
    avg(`c03039_consm_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_consm_amt_multi_avg_124,
    min(`c03039_enter_acct_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_32d as batch100421_card_amort_pay_agt_c03039_enter_acct_amt_multi_min_125,
    avg(`c03039_enter_acct_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_32d as batch100421_card_amort_pay_agt_c03039_enter_acct_amt_multi_avg_126,
    avg(`c03039_enter_acct_term`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_enter_acct_term_multi_avg_127,
    max(`c03039_enter_acct_term`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_enter_acct_term_multi_max_128,
    max(`c03039_mercht_comm_fee`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_mercht_comm_fee_multi_max_129,
    avg(`c03039_mercht_comm_fee`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_mercht_comm_fee_multi_avg_130,
    max(`c03039_od_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_od_amt_multi_max_131,
    max(`c03039_od_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_32d as batch100421_card_amort_pay_agt_c03039_od_amt_multi_max_132,
    min(`c03039_plan_term`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_plan_term_multi_min_133,
    avg(`c03039_plan_term`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_plan_term_multi_avg_134,
    max(`c03039_remain_term`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_remain_term_multi_max_135,
    avg(`c03039_remain_term`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_remain_term_multi_avg_136,
    max(`c03039_rtn_goods_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_rtn_goods_amt_multi_max_137,
    avg(`c03039_rtn_goods_amt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_rtn_goods_amt_multi_avg_138,
    min(`c03039_total_term`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_total_term_multi_min_139,
    avg(`c03039_total_term`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_total_term_multi_avg_140,
    case when !isnull(at(`c03039_agt_modif_num`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_agt_modif_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_agt_modif_num_multi_count_141,
    topn_frequency(`c03039_agt_modif_num`, 3) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_agt_modif_num_multi_top3frequency_142,
    distinct_count(`c03039_agt_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_agt_num_multi_unique_count_143,
    case when !isnull(at(`c03039_agt_num`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_agt_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_agt_num_multi_count_144,
    case when !isnull(at(`c03039_agt_status_cd`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_agt_status_cd`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_agt_status_cd_multi_count_145,
    distinct_count(`c03039_agt_status_cd`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_agt_status_cd_multi_unique_count_146,
    case when !isnull(at(`c03039_amort_pay_src_cd`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_amort_pay_src_cd`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_amort_pay_src_cd_multi_count_147,
    distinct_count(`c03039_amort_pay_src_cd`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_amort_pay_src_cd_multi_unique_count_148,
    distinct_count(`c03039_app_dt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_app_dt_multi_unique_count_149,
    case when !isnull(at(`c03039_app_dt`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_app_dt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_app_dt_multi_count_150,
    case when !isnull(at(`c03039_biz_type_num`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_biz_type_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_biz_type_num_multi_count_151,
    distinct_count(`c03039_biz_type_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_biz_type_num_multi_unique_count_152,
    case when !isnull(at(`c03039_cash_amort_ind`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_cash_amort_ind`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_cash_amort_ind_multi_count_153,
    topn_frequency(`c03039_cash_amort_ind`, 3) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_cash_amort_ind_multi_top3frequency_154,
    case when !isnull(at(`c03039_crdt_belong_org_num`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_crdt_belong_org_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_crdt_belong_org_num_multi_count_155,
    distinct_count(`c03039_crdt_belong_org_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_crdt_belong_org_num_multi_unique_count_156,
    case when !isnull(at(`c03039_curr_cd`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_curr_cd`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_curr_cd_multi_count_157,
    distinct_count(`c03039_curr_cd`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_curr_cd_multi_unique_count_158,
    distinct_count(`c03039_effect_dt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_effect_dt_multi_unique_count_159,
    case when !isnull(at(`c03039_effect_dt`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_effect_dt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_effect_dt_multi_count_160,
    case when !isnull(at(`c03039_indv_corp_ind`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_indv_corp_ind`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_indv_corp_ind_multi_count_161,
    distinct_count(`c03039_indv_corp_ind`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_indv_corp_ind_multi_unique_count_162,
    case when !isnull(at(`c03039_init_consm_dt`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_init_consm_dt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_init_consm_dt_multi_count_163,
    distinct_count(`c03039_init_consm_dt`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_init_consm_dt_multi_unique_count_164,
    case when !isnull(at(`c03039_init_consm_tx_index_ref_num`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_init_consm_tx_index_ref_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_init_consm_tx_index_ref_num_multi_count_165,
    distinct_count(`c03039_init_consm_tx_index_ref_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_init_consm_tx_index_ref_num_multi_unique_count_166,
    case when !isnull(at(`c03039_int_org_num`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_int_org_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_int_org_num_multi_count_167,
    distinct_count(`c03039_int_org_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_int_org_num_multi_unique_count_168,
    case when !isnull(at(`c03039_item_amort_ind`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_item_amort_ind`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_item_amort_ind_multi_count_169,
    topn_frequency(`c03039_item_amort_ind`, 3) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_item_amort_ind_multi_top3frequency_170,
    case when !isnull(at(`c03039_mcc_industry_cd`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_mcc_industry_cd`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_mcc_industry_cd_multi_count_171,
    distinct_count(`c03039_mcc_industry_cd`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_mcc_industry_cd_multi_unique_count_172,
    case when !isnull(at(`c03039_mercht_dept_num`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_mercht_dept_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_mercht_dept_num_multi_count_173,
    distinct_count(`c03039_mercht_dept_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_mercht_dept_num_multi_unique_count_174,
    case when !isnull(at(`c03039_proc_org_num`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_proc_org_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_proc_org_num_multi_count_175,
    distinct_count(`c03039_proc_org_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_proc_org_num_multi_unique_count_176,
    case when !isnull(at(`c03039_rela_cap_acct_modif_num`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_rela_cap_acct_modif_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_rela_cap_acct_modif_num_multi_count_177,
    distinct_count(`c03039_rela_cap_acct_modif_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_rela_cap_acct_modif_num_multi_unique_count_178,
    case when !isnull(at(`c03039_rela_cap_acct_num`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_rela_cap_acct_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_rela_cap_acct_num_multi_count_179,
    distinct_count(`c03039_rela_cap_acct_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_rela_cap_acct_num_multi_unique_count_180,
    case when !isnull(at(`c03039_rela_cap_card_num`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_rela_cap_card_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_rela_cap_card_num_multi_count_181,
    distinct_count(`c03039_rela_cap_card_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_rela_cap_card_num_multi_unique_count_182,
    case when !isnull(at(`c03039_tx_cd`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_tx_cd`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_tx_cd_multi_count_183,
    distinct_count(`c03039_tx_cd`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_tx_cd_multi_unique_count_184,
    case when !isnull(at(`c03039_yd_card_ind`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_yd_card_ind`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_yd_card_ind_multi_count_185,
    topn_frequency(`c03039_yd_card_ind`, 3) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_yd_card_ind_multi_top3frequency_186,
    case when !isnull(at(`c03039_zone_num`, 1)) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d then count(`c03039_zone_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d else null end as batch100421_card_amort_pay_agt_c03039_zone_num_multi_count_187,
    distinct_count(`c03039_zone_num`) over batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as batch100421_card_amort_pay_agt_c03039_zone_num_multi_unique_count_188
from
    (select `eventTime` as `ingestionTime`, '' as `c03039_agt_num`, '' as `c03039_agt_modif_num`, '' as `c03039_curr_cd`, '' as `c03039_zone_num`, '' as `c03039_int_org_num`, '' as `c03039_biz_type_num`, `cino` as `c03039_party_id`, '' as `c03039_agt_status_cd`, float(0) as `c03039_amort_pay_remain_amt`, float(0) as `c03039_amort_pay_tx_amt`, float(0) as `c03039_amort_pay_od_prin`, float(0) as `c03039_amort_pay_unback_cash_prin_amt`, float(0) as `c03039_amort_pay_deduct_amt`, float(0) as `c03039_amort_pay_adv_money_amt`, float(0) as `c03039_amort_pay_deflt_amt`, float(0) as `c03039_plan_term`, float(0) as `c03039_enter_acct_term`, float(0) as `c03039_remain_term`, float(0) as `c03039_total_term`, '' as `c03039_app_dt`, '' as `c03039_init_consm_dt`, float(0) as `c03039_enter_acct_amt`, float(0) as `c03039_consm_amt`, float(0) as `c03039_rtn_goods_amt`, float(0) as `c03039_od_amt`, '' as `c03039_mercht_dept_num`, '' as `c03039_rela_cap_acct_num`, '' as `c03039_rela_cap_acct_modif_num`, '' as `c03039_rela_cap_card_num`, '' as `c03039_init_consm_tx_index_ref_num`, '' as `c03039_indv_corp_ind`, '' as `c03039_yd_card_ind`, '' as `c03039_item_amort_ind`, '' as `c03039_amort_pay_src_cd`, '' as `c03039_mcc_industry_cd`, float(0) as `c03039_card_hlder_comm_fee`, float(0) as `c03039_mercht_comm_fee`, '' as `c03039_tx_cd`, '' as `c03039_proc_org_num`, '' as `c03039_effect_dt`, '' as `c03039_cash_amort_ind`, '' as `c03039_crdt_belong_org_num`, `previous_month_last_day` as `pt_dt`, reqId from `batch100426_flatten_request`)
    window batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_64d as (
UNION (select `ingestionTime`, `c03039_agt_num`, `c03039_agt_modif_num`, `c03039_curr_cd`, `c03039_zone_num`, `c03039_int_org_num`, `c03039_biz_type_num`, `c03039_party_id`, `c03039_agt_status_cd`, `c03039_amort_pay_remain_amt`, `c03039_amort_pay_tx_amt`, `c03039_amort_pay_od_prin`, `c03039_amort_pay_unback_cash_prin_amt`, `c03039_amort_pay_deduct_amt`, `c03039_amort_pay_adv_money_amt`, `c03039_amort_pay_deflt_amt`, `c03039_plan_term`, `c03039_enter_acct_term`, `c03039_remain_term`, `c03039_total_term`, `c03039_app_dt`, `c03039_init_consm_dt`, `c03039_enter_acct_amt`, `c03039_consm_amt`, `c03039_rtn_goods_amt`, `c03039_od_amt`, `c03039_mercht_dept_num`, `c03039_rela_cap_acct_num`, `c03039_rela_cap_acct_modif_num`, `c03039_rela_cap_card_num`, `c03039_init_consm_tx_index_ref_num`, `c03039_indv_corp_ind`, `c03039_yd_card_ind`, `c03039_item_amort_ind`, `c03039_amort_pay_src_cd`, `c03039_mcc_industry_cd`, `c03039_card_hlder_comm_fee`, `c03039_mercht_comm_fee`, `c03039_tx_cd`, `c03039_proc_org_num`, `c03039_effect_dt`, `c03039_cash_amort_ind`, `c03039_crdt_belong_org_num`, `pt_dt`, '' as reqId from `batch100421_card_amort_pay_agt`) partition by `c03039_party_id`,`pt_dt` order by `ingestionTime` rows_range between 64d preceding and 0s preceding INSTANCE_NOT_IN_WINDOW),
    batch100421_card_amort_pay_agt_c03039_party_id_pt_dt_ingestionTime_0s_32d as (
UNION (select `ingestionTime`, `c03039_agt_num`, `c03039_agt_modif_num`, `c03039_curr_cd`, `c03039_zone_num`, `c03039_int_org_num`, `c03039_biz_type_num`, `c03039_party_id`, `c03039_agt_status_cd`, `c03039_amort_pay_remain_amt`, `c03039_amort_pay_tx_amt`, `c03039_amort_pay_od_prin`, `c03039_amort_pay_unback_cash_prin_amt`, `c03039_amort_pay_deduct_amt`, `c03039_amort_pay_adv_money_amt`, `c03039_amort_pay_deflt_amt`, `c03039_plan_term`, `c03039_enter_acct_term`, `c03039_remain_term`, `c03039_total_term`, `c03039_app_dt`, `c03039_init_consm_dt`, `c03039_enter_acct_amt`, `c03039_consm_amt`, `c03039_rtn_goods_amt`, `c03039_od_amt`, `c03039_mercht_dept_num`, `c03039_rela_cap_acct_num`, `c03039_rela_cap_acct_modif_num`, `c03039_rela_cap_card_num`, `c03039_init_consm_tx_index_ref_num`, `c03039_indv_corp_ind`, `c03039_yd_card_ind`, `c03039_item_amort_ind`, `c03039_amort_pay_src_cd`, `c03039_mcc_industry_cd`, `c03039_card_hlder_comm_fee`, `c03039_mercht_comm_fee`, `c03039_tx_cd`, `c03039_proc_org_num`, `c03039_effect_dt`, `c03039_cash_amort_ind`, `c03039_crdt_belong_org_num`, `pt_dt`, '' as reqId from `batch100421_card_amort_pay_agt`) partition by `c03039_party_id`,`pt_dt` order by `ingestionTime` rows_range between 32d preceding and 0s preceding INSTANCE_NOT_IN_WINDOW))
as out3
on out0.reqId_1 = out3.reqId_108
last join
(
select
    reqId as reqId_190,
    min(`allyinte`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_7d as batch100422_dcm_bcs_bthcrdth_h_allyinte_multi_min_189,
    max(`allyinte`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_7d as batch100422_dcm_bcs_bthcrdth_h_allyinte_multi_max_190,
    min(`asintegr`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_7d as batch100422_dcm_bcs_bthcrdth_h_asintegr_multi_min_191,
    min(`asintegr`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_asintegr_multi_min_192,
    max(`atexcamt`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_atexcamt_multi_max_193,
    max(`atexcamt`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_atexcamt_multi_max_194,
    min(`balance`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_balance_multi_min_195,
    min(`balance`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_balance_multi_min_196,
    min(`cfeeamt`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_7d as batch100422_dcm_bcs_bthcrdth_h_cfeeamt_multi_min_197,
    min(`cfeeamt`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_cfeeamt_multi_min_198,
    min(`lstbal`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_lstbal_multi_min_199,
    min(`lstbal`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_lstbal_multi_min_200,
    min(`merrate`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_7d as batch100422_dcm_bcs_bthcrdth_h_merrate_multi_min_201,
    min(`merrate`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_merrate_multi_min_202,
    min(`refamt`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_7d as batch100422_dcm_bcs_bthcrdth_h_refamt_multi_min_203,
    min(`refamt`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_refamt_multi_min_204,
    max(`spintegr`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_spintegr_multi_max_205,
    max(`spintegr`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_spintegr_multi_max_206,
    min(`tipamt`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_7d as batch100422_dcm_bcs_bthcrdth_h_tipamt_multi_min_207,
    min(`tipamt`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_tipamt_multi_min_208,
    avg(`trxamt`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_trxamt_multi_avg_209,
    avg(`trxamt`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_trxamt_multi_avg_210,
    distinct_count(`accfix`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_accfix_multi_unique_count_211,
    distinct_count(`accfix`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_accfix_multi_unique_count_212,
    case when !isnull(at(`accino`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`accino`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_accino_multi_count_213,
    case when !isnull(at(`accino`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`accino`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_accino_multi_count_214,
    distinct_count(`accno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_accno_multi_unique_count_215,
    distinct_count(`accno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_accno_multi_unique_count_216,
    topn_frequency(`agentname`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_agentname_multi_top3frequency_217,
    topn_frequency(`agentname`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_agentname_multi_top3frequency_218,
    distinct_count(`authno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_authno_multi_unique_count_219,
    distinct_count(`authno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_authno_multi_unique_count_220,
    topn_frequency(`authtlno`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_authtlno_multi_top3frequency_221,
    topn_frequency(`authtlno`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_authtlno_multi_top3frequency_222,
    case when !isnull(at(`bkamt1`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`bkamt1`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_bkamt1_multi_count_223,
    case when !isnull(at(`bkamt1`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`bkamt1`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_bkamt1_multi_count_224,
    topn_frequency(`bkamt2`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_bkamt2_multi_top3frequency_225,
    topn_frequency(`bkamt2`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_bkamt2_multi_top3frequency_226,
    topn_frequency(`bkamt3`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_bkamt3_multi_top3frequency_227,
    topn_frequency(`bkamt3`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_bkamt3_multi_top3frequency_228,
    topn_frequency(`bkamt4`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_bkamt4_multi_top3frequency_229,
    topn_frequency(`bkamt4`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_bkamt4_multi_top3frequency_230,
    topn_frequency(`bkamt5`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_bkamt5_multi_top3frequency_231,
    topn_frequency(`bkamt5`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_bkamt5_multi_top3frequency_232,
    topn_frequency(`bknotes`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_bknotes_multi_top3frequency_233,
    topn_frequency(`bknotes`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_bknotes_multi_top3frequency_234,
    distinct_count(`bknotes2`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_bknotes2_multi_unique_count_235,
    distinct_count(`bknotes2`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_bknotes2_multi_unique_count_236,
    case when !isnull(at(`brno`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`brno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_brno_multi_count_237,
    case when !isnull(at(`brno`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`brno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_brno_multi_count_238,
    case when !isnull(at(`busidate`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`busidate`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_busidate_multi_count_239,
    case when !isnull(at(`busidate`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`busidate`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_busidate_multi_count_240,
    distinct_count(`busitime`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_busitime_multi_unique_count_241,
    distinct_count(`busitime`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_busitime_multi_unique_count_242,
    topn_frequency(`cashf`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_cashf_multi_top3frequency_243,
    topn_frequency(`cashf`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_cashf_multi_top3frequency_244,
    topn_frequency(`channo`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_channo_multi_top3frequency_245,
    topn_frequency(`channo`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_channo_multi_top3frequency_246,
    topn_frequency(`chantype`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_chantype_multi_top3frequency_247,
    topn_frequency(`chantype`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_chantype_multi_top3frequency_248,
    topn_frequency(`currtype`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_currtype_multi_top3frequency_249,
    topn_frequency(`currtype`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_currtype_multi_top3frequency_250,
    case when !isnull(at(`dbcrf`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`dbcrf`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_dbcrf_multi_count_251,
    case when !isnull(at(`dbcrf`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`dbcrf`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_dbcrf_multi_count_252,
    distinct_count(`emvwrmod`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_emvwrmod_multi_unique_count_253,
    distinct_count(`emvwrmod`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_emvwrmod_multi_unique_count_254,
    distinct_count(`eserialno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_eserialno_multi_unique_count_255,
    distinct_count(`eserialno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_eserialno_multi_unique_count_256,
    topn_frequency(`esubseqno`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_esubseqno_multi_top3frequency_257,
    topn_frequency(`esubseqno`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_esubseqno_multi_top3frequency_258,
    topn_frequency(`listflag`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_listflag_multi_top3frequency_259,
    topn_frequency(`listflag`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_listflag_multi_top3frequency_260,
    distinct_count(`mcccode`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_mcccode_multi_unique_count_261,
    distinct_count(`mcccode`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_mcccode_multi_unique_count_262,
    distinct_count(`mdcardno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_mdcardno_multi_unique_count_263,
    distinct_count(`mdcardno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_mdcardno_multi_unique_count_264,
    topn_frequency(`mdkmode`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_mdkmode_multi_top3frequency_265,
    topn_frequency(`mdkmode`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_mdkmode_multi_top3frequency_266,
    case when !isnull(at(`merchno`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`merchno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_merchno_multi_count_267,
    case when !isnull(at(`merchno`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`merchno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_merchno_multi_count_268,
    case when !isnull(at(`merno`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`merno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_merno_multi_count_269,
    case when !isnull(at(`merno`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`merno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_merno_multi_count_270,
    distinct_count(`mserialn`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_mserialn_multi_unique_count_271,
    distinct_count(`mserialn`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_mserialn_multi_unique_count_272,
    case when !isnull(at(`oflflag`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`oflflag`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_oflflag_multi_count_273,
    case when !isnull(at(`oflflag`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`oflflag`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_oflflag_multi_count_274,
    topn_frequency(`onusexif`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_onusexif_multi_top3frequency_275,
    topn_frequency(`onusexif`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_onusexif_multi_top3frequency_276,
    case when !isnull(at(`openzone`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`openzone`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_openzone_multi_count_277,
    case when !isnull(at(`openzone`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`openzone`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_openzone_multi_count_278,
    topn_frequency(`orderno`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_orderno_multi_top3frequency_279,
    topn_frequency(`orderno`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_orderno_multi_top3frequency_280,
    distinct_count(`oserialn`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_oserialn_multi_unique_count_281,
    distinct_count(`oserialn`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_oserialn_multi_unique_count_282,
    topn_frequency(`otrxserno`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_otrxserno_multi_top3frequency_283,
    topn_frequency(`otrxserno`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_otrxserno_multi_top3frequency_284,
    topn_frequency(`prirecf`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_prirecf_multi_top3frequency_285,
    topn_frequency(`prirecf`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_prirecf_multi_top3frequency_286,
    case when !isnull(at(`prodid`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`prodid`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_prodid_multi_count_287,
    case when !isnull(at(`prodid`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`prodid`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_prodid_multi_count_288,
    topn_frequency(`progmsg`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_progmsg_multi_top3frequency_289,
    topn_frequency(`progmsg`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_progmsg_multi_top3frequency_290,
    distinct_count(`rbrno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_rbrno_multi_unique_count_291,
    distinct_count(`rbrno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_rbrno_multi_unique_count_292,
    case when !isnull(at(`recipact`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`recipact`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_recipact_multi_count_293,
    case when !isnull(at(`recipact`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`recipact`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_recipact_multi_count_294,
    case when !isnull(at(`recipbkname`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`recipbkname`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_recipbkname_multi_count_295,
    case when !isnull(at(`recipbkname`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`recipbkname`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_recipbkname_multi_count_296,
    case when !isnull(at(`recipbkno`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`recipbkno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_recipbkno_multi_count_297,
    case when !isnull(at(`recipbkno`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`recipbkno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_recipbkno_multi_count_298,
    topn_frequency(`recipcty`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_recipcty_multi_top3frequency_299,
    topn_frequency(`recipcty`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_recipcty_multi_top3frequency_300,
    topn_frequency(`recsqno`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_recsqno_multi_top3frequency_301,
    topn_frequency(`recsqno`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_recsqno_multi_top3frequency_302,
    topn_frequency(`rprodid`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_rprodid_multi_top3frequency_303,
    topn_frequency(`rprodid`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_rprodid_multi_top3frequency_304,
    case when !isnull(at(`rsavname`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`rsavname`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_rsavname_multi_count_305,
    case when !isnull(at(`rsavname`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`rsavname`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_rsavname_multi_count_306,
    topn_frequency(`servface`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_servface_multi_top3frequency_307,
    topn_frequency(`servface`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_servface_multi_top3frequency_308,
    case when !isnull(at(`tellerno`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`tellerno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_tellerno_multi_count_309,
    case when !isnull(at(`tellerno`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`tellerno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_tellerno_multi_count_310,
    distinct_count(`terno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_terno_multi_unique_count_311,
    distinct_count(`terno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_terno_multi_unique_count_312,
    case when !isnull(at(`timestmp`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`timestmp`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_timestmp_multi_count_313,
    case when !isnull(at(`timestmp`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`timestmp`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_timestmp_multi_count_314,
    topn_frequency(`trxcode`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_trxcode_multi_top3frequency_315,
    topn_frequency(`trxcode`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_trxcode_multi_top3frequency_316,
    topn_frequency(`trxcountry`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_trxcountry_multi_top3frequency_317,
    topn_frequency(`trxcountry`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_trxcountry_multi_top3frequency_318,
    topn_frequency(`trxcurdicp`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_trxcurdicp_multi_top3frequency_319,
    topn_frequency(`trxcurdicp`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_trxcurdicp_multi_top3frequency_320,
    topn_frequency(`trxcurr`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_trxcurr_multi_top3frequency_321,
    topn_frequency(`trxcurr`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_trxcurr_multi_top3frequency_322,
    case when !isnull(at(`trxdate`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`trxdate`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_trxdate_multi_count_323,
    case when !isnull(at(`trxdate`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`trxdate`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_trxdate_multi_count_324,
    topn_frequency(`trxdiscp`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_trxdiscp_multi_top3frequency_325,
    topn_frequency(`trxdiscp`, 3) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_trxdiscp_multi_top3frequency_326,
    distinct_count(`trxserno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as batch100422_dcm_bcs_bthcrdth_h_trxserno_multi_unique_count_327,
    distinct_count(`trxserno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as batch100422_dcm_bcs_bthcrdth_h_trxserno_multi_unique_count_328,
    case when !isnull(at(`trxsite`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`trxsite`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_trxsite_multi_count_329,
    case when !isnull(at(`trxsite`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`trxsite`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_trxsite_multi_count_330,
    case when !isnull(at(`zoneno`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d then count(`zoneno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d else null end as batch100422_dcm_bcs_bthcrdth_h_zoneno_multi_count_331,
    case when !isnull(at(`zoneno`, 1)) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d then count(`zoneno`) over batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d else null end as batch100422_dcm_bcs_bthcrdth_h_zoneno_multi_count_332
from
    (select `eventTime` as `ingestionTime`, '' as `zoneno`, '' as `openzone`, '' as `accfix`, '' as `accno`, '' as `currtype`, '' as `mdcardno`, '' as `busidate`, '' as `busitime`, '' as `trxserno`, '' as `trxcode`, '' as `dbcrf`, '' as `listflag`, '' as `mdkmode`, float(0) as `balance`, float(0) as `lstbal`, '' as `trxcurr`, float(0) as `trxamt`, '' as `trxdate`, '' as `brno`, '' as `tellerno`, '' as `authtlno`, '' as `servface`, '' as `merno`, '' as `terno`, '' as `trxsite`, float(0) as `tipamt`, float(0) as `cfeeamt`, float(0) as `merrate`, '' as `prirecf`, '' as `recsqno`, float(0) as `asintegr`, float(0) as `spintegr`, float(0) as `allyinte`, float(0) as `refamt`, '' as `timestmp`, '' as `trxdiscp`, '' as `mcccode`, '' as `trxcountry`, '' as `trxcurdicp`, '' as `authno`, '' as `otrxserno`, '' as `bknotes`, '' as `bkamt1`, '' as `bkamt2`, '' as `bkamt3`, '' as `bkamt4`, '' as `bkamt5`, '' as `bknotes2`, '' as `prodid`, '' as `eserialno`, '' as `esubseqno`, '' as `mserialn`, '' as `oserialn`, '' as `chantype`, '' as `channo`, '' as `recipact`, '' as `recipcty`, '' as `rsavname`, '' as `rprodid`, '' as `rbrno`, '' as `orderno`, bigint(0) as `atexcamt`, '' as `progmsg`, '' as `emvwrmod`, '' as `merchno`, '' as `oflflag`, '' as `accino`, `cino` as `cino`, '' as `recipbkname`, '' as `recipbkno`, '' as `agentname`, '' as `cashf`, '' as `onusexif`, `previous_month_last_day` as `pt_dt`, reqId from `batch100426_flatten_request`)
    window batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_7d as (
UNION (select `ingestionTime`, `zoneno`, `openzone`, `accfix`, `accno`, `currtype`, `mdcardno`, `busidate`, `busitime`, `trxserno`, `trxcode`, `dbcrf`, `listflag`, `mdkmode`, `balance`, `lstbal`, `trxcurr`, `trxamt`, `trxdate`, `brno`, `tellerno`, `authtlno`, `servface`, `merno`, `terno`, `trxsite`, `tipamt`, `cfeeamt`, `merrate`, `prirecf`, `recsqno`, `asintegr`, `spintegr`, `allyinte`, `refamt`, `timestmp`, `trxdiscp`, `mcccode`, `trxcountry`, `trxcurdicp`, `authno`, `otrxserno`, `bknotes`, `bkamt1`, `bkamt2`, `bkamt3`, `bkamt4`, `bkamt5`, `bknotes2`, `prodid`, `eserialno`, `esubseqno`, `mserialn`, `oserialn`, `chantype`, `channo`, `recipact`, `recipcty`, `rsavname`, `rprodid`, `rbrno`, `orderno`, `atexcamt`, `progmsg`, `emvwrmod`, `merchno`, `oflflag`, `accino`, `cino`, `recipbkname`, `recipbkno`, `agentname`, `cashf`, `onusexif`, `pt_dt`, '' as reqId from `batch100422_dcm_bcs_bthcrdth_h`) partition by `cino`,`pt_dt` order by `ingestionTime` rows_range between 7d preceding and 0s preceding INSTANCE_NOT_IN_WINDOW),
    batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_64d as (
UNION (select `ingestionTime`, `zoneno`, `openzone`, `accfix`, `accno`, `currtype`, `mdcardno`, `busidate`, `busitime`, `trxserno`, `trxcode`, `dbcrf`, `listflag`, `mdkmode`, `balance`, `lstbal`, `trxcurr`, `trxamt`, `trxdate`, `brno`, `tellerno`, `authtlno`, `servface`, `merno`, `terno`, `trxsite`, `tipamt`, `cfeeamt`, `merrate`, `prirecf`, `recsqno`, `asintegr`, `spintegr`, `allyinte`, `refamt`, `timestmp`, `trxdiscp`, `mcccode`, `trxcountry`, `trxcurdicp`, `authno`, `otrxserno`, `bknotes`, `bkamt1`, `bkamt2`, `bkamt3`, `bkamt4`, `bkamt5`, `bknotes2`, `prodid`, `eserialno`, `esubseqno`, `mserialn`, `oserialn`, `chantype`, `channo`, `recipact`, `recipcty`, `rsavname`, `rprodid`, `rbrno`, `orderno`, `atexcamt`, `progmsg`, `emvwrmod`, `merchno`, `oflflag`, `accino`, `cino`, `recipbkname`, `recipbkno`, `agentname`, `cashf`, `onusexif`, `pt_dt`, '' as reqId from `batch100422_dcm_bcs_bthcrdth_h`) partition by `cino`,`pt_dt` order by `ingestionTime` rows_range between 64d preceding and 0s preceding INSTANCE_NOT_IN_WINDOW),
    batch100422_dcm_bcs_bthcrdth_h_cino_pt_dt_ingestionTime_0s_32d as (
UNION (select `ingestionTime`, `zoneno`, `openzone`, `accfix`, `accno`, `currtype`, `mdcardno`, `busidate`, `busitime`, `trxserno`, `trxcode`, `dbcrf`, `listflag`, `mdkmode`, `balance`, `lstbal`, `trxcurr`, `trxamt`, `trxdate`, `brno`, `tellerno`, `authtlno`, `servface`, `merno`, `terno`, `trxsite`, `tipamt`, `cfeeamt`, `merrate`, `prirecf`, `recsqno`, `asintegr`, `spintegr`, `allyinte`, `refamt`, `timestmp`, `trxdiscp`, `mcccode`, `trxcountry`, `trxcurdicp`, `authno`, `otrxserno`, `bknotes`, `bkamt1`, `bkamt2`, `bkamt3`, `bkamt4`, `bkamt5`, `bknotes2`, `prodid`, `eserialno`, `esubseqno`, `mserialn`, `oserialn`, `chantype`, `channo`, `recipact`, `recipcty`, `rsavname`, `rprodid`, `rbrno`, `orderno`, `atexcamt`, `progmsg`, `emvwrmod`, `merchno`, `oflflag`, `accino`, `cino`, `recipbkname`, `recipbkno`, `agentname`, `cashf`, `onusexif`, `pt_dt`, '' as reqId from `batch100422_dcm_bcs_bthcrdth_h`) partition by `cino`,`pt_dt` order by `ingestionTime` rows_range between 32d preceding and 0s preceding INSTANCE_NOT_IN_WINDOW))
as out4
on out0.reqId_1 = out4.reqId_190
;
